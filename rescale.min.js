/*!
 * rescale.js v1.1 | MIT License | (c) 2024 Maksim Postnikov
 * https://postnikovmd.com/mods/license
 */

!function(e){let t=function(e){void 0===e&&(e={}),void 0===window.rescale&&(window.rescale={}),void 0===e.selector&&(e.selector=".t-rec");let t,i;function a(){document.querySelectorAll(e.selector).length>0?document.querySelectorAll(e.selector).forEach(t=>{r("#"+t.id,e)}):console.error("[rescale.js] Ошибка: Не найдено ни одного блока с указанным селектором: "+e.selector)}window.t396__isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||-1<navigator.userAgent.indexOf("Instagram"),window.t396__isIPad="ontouchend"in document&&-1!==navigator.userAgent.indexOf("AppleWebKit"),window.t396__isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),window.rescale.currentWidth=window.innerWidth,(window.t396__isMobile||window.t396__isIPad)&&(window.rescale.currentWidth=document.documentElement.clientWidth),window.rescale.trigger="page",a(),window.addEventListener("resize",function(){window.screen.width!==i&&(clearTimeout(t),t=setTimeout(function(){a(),i=window.screen.width},500)),window.rescale.currentWidth=window.innerWidth,(window.t396__isMobile||window.t396__isIPad)&&(window.rescale.currentWidth=document.documentElement.clientWidth)})},r=function(e,t){if(window.rescale.trigger&&"page"===window.rescale.trigger)void 0!==t.min?void 0!==t.max?(t.max%10==0&&(t.max-=1),t.min<t.max?window.rescale.currentWidth>=t.min&&window.rescale.currentWidth<t.max&&(i(e,t),window.rescale.this=!0):console.error("[rescale.js] Ошибка: Минимальный брейкпоинт (min) не может быть больше, чем максимальный (max)")):window.rescale.currentWidth>=t.min&&(i(e,t),window.rescale.this=!0):void 0!==t.max?(t.max%10==0&&(t.max-=1),window.rescale.currentWidth<t.max&&(i(e,t),window.rescale.this=!0)):console.error("[rescale.js] Ошибка: Не заданы ключевые брейкпоинты min и max");else{void 0===t&&(t={});let r,a;window.t396__isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||-1<navigator.userAgent.indexOf("Instagram"),window.t396__isIPad="ontouchend"in document&&-1!==navigator.userAgent.indexOf("AppleWebKit"),window.rescale.currentWidth=window.innerWidth,(window.t396__isMobile||window.t396__isIPad)&&(window.rescale.currentWidth=document.documentElement.clientWidth),window.rescale.trigger="block",window.addEventListener("load",function(){i(e,t)}),window.addEventListener("resize",function(){window.screen.width!==a&&(clearTimeout(r),r=setTimeout(function(){i(e,t),a=window.screen.width},500)),window.rescale.currentWidth=window.innerWidth,(window.t396__isMobile||window.t396__isIPad)&&(window.rescale.currentWidth=document.documentElement.clientWidth)})}},i=function(e,t){let r=document.querySelector(e);e=e.replace("#rec","");let i=r.getAttribute("data-record-type"),o=r.querySelector(".t396__artboard"),l=1;if(("396"===i||"121"===i)&&o){if("window"===o.getAttribute("data-artboard-upscale")){if(void 0===window.rescale["ab"+e]&&(window.rescale["ab"+e]={}),t.min&&(window.rescale["ab"+e].min=t.min),t.max&&(window.rescale["ab"+e].max=t.max),t.keep&&(window.rescale["ab"+e].keep=t.keep),t.direction&&(window.rescale["ab"+e].direction=t.direction),window.t396__isIPad||window.t396__isMobile&&window.t396__isSafari){if(o.classList.contains("t396__artboard_scale"))n(e);else{var c=new MutationObserver(function(t){for(var r of t)"attributes"===r.type&&"class"===r.attributeName&&o.classList.contains("t396__artboard_scale")&&(n(e),c.disconnect())});c.observe(o,{attributes:!0})}}l=a(e),window.rescale["ab"+e].scaleFactor=l,window.rescale.scale=l,document.documentElement.style.setProperty("--scale-factor",l)}else console.warn("[rescale.js] Предупреждение: Блок (id: #rec"+e+") нельзя масштабировать, так как у него выключен автоскейл")}else if("131"===i||"215"===i||"1093"===i)r.style.zoom="";else{if("page"===window.rescale.trigger&&window.rescale.scale)l=window.rescale.scale;else{let d=document.querySelector(".t396__artboard");if(void 0===t.direction&&(t.direction="upscale"),d){if(void 0===window.tn&&(window.tn={}),window.tn.ab_fields=["height","width","bgcolor","bgimg","bgattachment","bgposition","filteropacity","filtercolor","filteropacity2","filtercolor2","height_vh","valign"],"function"==typeof window.t396_setScreensTNobj&&t396_setScreensTNobj(e,d),void 0===window.tn.curResolution){let u=d.getAttribute("data-artboard-screens").split(",").map(Number).filter(e=>e<=window.innerWidth).reduce((e,t)=>Math.max(e,t),0);window.tn.curResolution=u}}else console.error("[rescale.js] Ошибка: На странице не найдено ни одного Zero-блока");switch(t.direction){case"upscale":l=Number(parseFloat(window.innerWidth/window.tn.curResolution).toFixed(3));break;case"downscale":l=Number(parseFloat(window.tn.curResolution/window.innerWidth).toFixed(3))}}window.rescale.scale=l,window.tn_scale_factor=l,document.documentElement.style.setProperty("--scale-factor",l),r.style.zoom="var(--scale-factor)",(window.t396__isIPad||window.t396__isMobile&&window.t396__isSafari)&&s(e)}},a=function(e){let t=window.rescale["ab"+e].min,r=window.rescale["ab"+e].max,i=window.rescale["ab"+e].keep,a=window.rescale["ab"+e].direction,n,s,o,l,c,d,u=document.querySelector("#rec"+e).querySelector(".t396__artboard");if(u){let h=u.getAttribute("data-artboard-screens").split(",").map(Number);if(window.rescale["ab"+e].screens=h,void 0!==t||void 0!==r){if(a){switch(void 0===t&&void 0!==r&&(l=[r],c="min"),void 0!==t&&void 0!==r&&(l=[t,r],c="between"),void 0!==t&&void 0===r&&(l=[t],c="max"),window.rescale["ab"+e].breakpoints=l,c){case"min":a="downscale";break;case"between":break;case"max":a="upscale"}switch(window.rescale["ab"+e].direction=a,a){case"upscale":o=l[0];break;case"downscale":"max"!==c?o=l[1]:console.error("[rescale.js] Ошибка: Невозможно применить обратное масштабирование к наибольшему адаптиву (id: #rec"+e+")")}if(o){if(h){for(let f=0;f<h.length;f++)if(window.rescale.currentWidth<=h[f]){n=[h[f-1]||void 0,h[f]];break}if(window.rescale.currentWidth>h[h.length-1]&&(n=[h[h.length-1],void 0]),window.rescale["ab"+e].resolution=n,n){switch(a){case"upscale":s=n[0];break;case"downscale":s=void 0!==n[1]&&window.rescale.currentWidth<=n[1]?n[1]:n[0]}return"between"===c?d=parseFloat((window.rescale.currentWidth/o).toFixed(3)):"max"===c&&(t===n[0]&&(d=parseFloat((window.rescale.currentWidth/o).toFixed(3))),t>n[0]&&(window.rescale.currentWidth>=t?d=parseFloat((window.rescale.currentWidth/o).toFixed(3)):window.rescale.currentWidth>=n[0]&&(d=1)),i&&window.rescale.currentWidth>=i&&(d=parseFloat((i/o).toFixed(3)))),window.rescale["ab"+e].grid_width=s,window.rescale.grid_width=s,window.rescale["ab"+e].grid_offset_left=parseInt(Math.round((window.rescale.currentWidth/d-s)/2)),window.rescale.grid_offset_left=window.rescale["ab"+e].grid_offset_left,d}console.error("[rescale.js] Ошибка: Некорректно рассчитан текущий брейкпоинт блока (id: #rec"+e+")")}else console.error("[rescale.js] Ошибка: Невозможно получить брейкпоинты блока (id: #rec"+e+")")}}else console.error("[rescale.js] Ошибка: Не задано направление масштабирования")}else console.error("[rescale.js] Ошибка: Не заданы ключевые брейкпоинты min и max")}else console.error("[rescale.js] Ошибка: Не найден артборд блока (id: #rec"+e+")")},n=function(e){let t=document.querySelector("#rec"+e).querySelector(".t396__artboard"),r=t.querySelectorAll(".tn-elem");r&&r.forEach(e=>{let t=e.getAttribute("data-elem-type"),r=e.querySelector(".tn-atom");if("grid"===t396_elem__getFieldValue(e,"container")){if("text"===t||"button"===t){if("button"===t&&(r=e.children[0]),isSafari&&window.t396__isIPad&&!e.closest(".tn-group")){e.style.zoom="",r.style.fontSize="";let i=parseFloat(getComputedStyle(r).fontSize);r.style.webkitTextSizeAdjust,r.style.webkitTextSizeAdjust="none",e.style.zoom=window.rescale.scale;let a=parseFloat(getComputedStyle(r).fontSize);Math.abs(i-a)>=1?(r.style.fontSize=Math.round(i*window.rescale.scale)+"px",r.style.webkitTextSizeAdjust="none"):r.style.webkitTextSizeAdjust="",r.style.lineHeight=""}let n=r.querySelectorAll("a:not(:has(*)), span, strong, em");n.length>0&&n.forEach(e=>{e.style.fontSize="",e.style.zoom="1.001",e.style.webkitTextSizeAdjust="none",e.classList.add("fix")}),r.style.fontSize="",r.style.zoom="1.001",r.style.webkitTextSizeAdjust="none",r.classList.add("fix"),"button"===t&&r.classList.contains("js-click-zero-stat")&&window.addEventListener("load",function(){setTimeout(function(){let t=e.querySelector(".tn-atom");t.style.fontSize="",t.style.zoom="1.001",t.style.webkitTextSizeAdjust="none"},500)}),window.rescale.currentWidth>=480&&window.rescale.currentWidth<1200&&!isSafari&&(r.style.webkitTextSizeAdjust="auto")}"form"===t&&window.addEventListener("load",function(){setTimeout(function(){let t=e.querySelector("form").querySelectorAll("input, textarea, select, label");t&&t.forEach(e=>{e.style.zoom="1.001",e.style.webkitTextSizeAdjust="none"})},500)})}})},s=function(e){let t=document.querySelector("#rec"+e),r=t.querySelectorAll("div");r&&r.forEach(e=>{0===Array.from(e.childNodes).filter(e=>"DIV"===e.nodeName||"A"===e.nodeName).length&&void 0!==e.innerText&&(e.style.zoom="1.001",e.style.webkitTextSizeAdjust="none")});let i=t.querySelectorAll("a, button, span, em, strong");i&&i.forEach(e=>{0===Array.from(e.childNodes).filter(e=>"DIV"===e.nodeName).length&&void 0!==e.innerText&&(e.style.zoom="1.001",e.style.webkitTextSizeAdjust="none")})},o=function(){window.t396__setGlobalScaleVariables=function(e,t,r){if(window.tn_window_width=document.documentElement.clientWidth,r){if(window.rescale&&window.rescale.this)window.rescale["ab"+e]?(window.tn["ab"+e].scaleFactor=window.rescale["ab"+e].scaleFactor,window.tn_scale_factor=window.rescale["ab"+e].scaleFactor):(window.tn["ab"+e].scaleFactor=window.rescale.scale,window.tn_scale_factor=window.rescale.scale);else{let i=parseFloat((window.tn_window_width/t).toFixed(3));window.tn["ab"+e].scaleFactor=i,window.tn_scale_factor=i}}else window.tn["ab"+e].scaleFactor=1,window.tn_scale_factor=1},window.t396_updateTNobj=function(e){window.tn.window_width=document.documentElement.clientWidth;var t,r=t396__getAxisXPadding();r&&(window.tn.window_width-=r),window.t396__isMobile?window.tn.window_height=document.documentElement.clientHeight:window.tn.window_height=window.innerHeight;for(var i=document.querySelector("#rec"+e),e="ab"+e,a=window.tn[e].screens.slice().reverse(),n=0;n<a.length;n++)if(window.tn[e].curResolution===a[n]){window.tn[e].canvas_min_width=a[n],0===n?window.tn[e].canvas_max_width=window.tn.window_width:window.tn[e].canvas_max_width=a[n-1];break}t=!!i&&"window"===i.querySelector(".t396__artboard").getAttribute("data-artboard-upscale"),window.rescale[e]&&window.tn.window_width!==window.tn[e].curResolution&&t?(window.tn[e].grid_width=window.rescale[e].grid_width,window.tn[e].grid_offset_left=window.rescale[e].grid_offset_left):window.rescale&&window.tn.window_width!==window.tn[e].curResolution&&window.rescale.this&&t?(window.tn[e].grid_width=window.rescale.grid_width,window.tn[e].grid_offset_left=window.rescale.grid_offset_left):(window.tn[e].grid_width=window.tn[e].canvas_min_width,window.tn[e].grid_offset_left=(window.tn.window_width-window.tn[e].grid_width)/2)},window.t396_elem__convertPosition__Local__toAbsolute=function(e,t,r){if(e=t396_getEl(e)){var i=e.closest(".t396__artboard"),a=i.getAttribute("data-artboard-recid"),n=t396_ab__getFieldValue(i,"valign"),s="window"===t396_ab__getFieldValue(i,"upscale"),i=document.getElementById("allrecords"),o="edit"===(i?i.getAttribute("data-tilda-mode"):""),l=t396_isOnlyScalableBrowser(),c=!o&&s&&l,d=!o&&s&&!l,u=t396_elem__getFieldValue(e,"axisy"),h=t396_elem__getFieldValue(e,"axisx"),f=t396_elem__getFieldValue(e,"container"),i=e.classList.contains("tn-group")&&"physical"===t396_group__getFieldValue(e,"type"),b=e.parentNode.closest(".tn-group"),w="physical"===t396_group__getFieldValue(b,"type"),g=(i&&(f="grid"),r=parseInt(r),t396__getCurrentScaleFactor(a));switch(t){case"left":if(m="grid"===f?"grid":"window",$="grid"===f?window.tn["ab"+a].grid_offset_left:0,y="grid"===f?window.tn["ab"+a].grid_width:window.tn.window_width,"%"===t396_elem__getFieldValue(e,"leftunits")&&(r=t396_roundFloat(y*r/100)),w){var m,$,y,p=parseInt(t396_group__getFieldValue(b,"left"),10);r-=p="%"===t396_group__getFieldValue(b,"leftunits")?t396_roundFloat(y*p/100):p;break}!o&&s?"grid"===m&&(l?r*=g:$+r>=r&&(r=$+r)):r=$+r,"center"===h&&(S=t396_elem__getWidth(e),c&&"window"!==m&&(y*=g,S*=g),r=y/2-S/2+r),"right"===h&&(S=t396_elem__getWidth(e),c&&"window"!==m&&(y*=g,S*=g),r=y-S+r),c&&"window"!==m&&(r+=((S=t396_elem__getWidth(e))*g-S)/2);break;case"top":function v(e){var t,r,i=t396_elem__getHeight(e);return e&&"image"===e.getAttribute("data-elem-type")&&(t=t396_elem__getWidth(e),r=t396_elem__getFieldValue(e,"filewidth"),e=t396_elem__getFieldValue(e,"fileheight"),r&&e&&(i=t/(parseInt(r)/parseInt(e)))),i}var p=e.closest(".t396__artboard"),x=p?p.getAttribute("data-artboard-proxy-min-offset-top"):"0",_=p?p.getAttribute("data-artboard-proxy-min-height"):"0",S=p?p.getAttribute("data-artboard-proxy-max-height"):"0";if(m="grid"===f?"grid":"window",x="grid"===f?parseFloat(x):0,_="grid"===f?parseFloat(_):parseFloat(S),"%"===t396_elem__getFieldValue(e,"topunits")&&(r=_*(r/100)),w){S=parseInt(t396_group__getFieldValue(b,"top"),10),r-=S="%"===t396_group__getFieldValue(b,"topunits")?t396_roundFloat(_*S/100):S;break}c&&"window"!==m&&(r*=g),r=(x=d&&"window"!==m?"stretch"===n?0:x/g:x)+r;var A,W,S=t396_ab__getFieldValue(p,"height_vh"),x=t396_ab__getFieldValue(p,"height"),k=t396_ab__getHeight(p);s&&!o&&S&&(A=parseInt(x,10)*g),"center"===u&&(W=v(e),c&&"window"!==m&&("stretch"!==n?_*=g:_=A?k<A?A:k:p.clientHeight,W*=g),o||!s||l||"window"===m||"stretch"!==n||(_=A?k<A?A:k:p.clientHeight,_/=g),r=_/2-W/2+r),"bottom"===u&&(W=v(e),c&&"window"!==m&&("stretch"!==n?_*=g:_=A?k<A?A:k:p.clientHeight,W*=g),o||!s||l||"window"===m||"stretch"!==n||(_=A?k<A?A:k:p.clientHeight,_/=g),r=_-W+r),c&&"window"!==m&&(S=((W=v(e))*g-W)/2,r+=S=Math.round(S))}return r}}};window.t396__setGlobalScaleVariables&&"function"==typeof window.t396__setGlobalScaleVariables?o():document.querySelector('script[src*="tilda-zero-1.1.min.js"]').addEventListener("load",function(){o()}),void 0===window.postnikovmd&&(window.postnikovmd="Maksim Postnikov, https://postnikovmd.com"),e.rescale={init:t,block:r,copyright:"\xa9 "+window.postnikovmd,version:"1.1"}}(window);
