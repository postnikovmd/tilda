/*!
 * media.js v1.1 | MIT License | (c) 2024 Maksim Postnikov
 * https://postnikovmd.com/mods/license
 */

!function(e){let t=function(e,t,o){const l=document.querySelectorAll(e)[t];l.classList.contains("loaded")||(l.querySelector(".tn-atom").click(),l.classList.add("loaded"))},o=function(e,t,o){o.pauseAll&&i(e,o),setTimeout((function(){null==t&&(t=0);const l=document.querySelectorAll(e)[t];if(!l.classList.contains("playing")&&(l.querySelector("video").play(),l.classList.add("playing"),o.controls)){const e=l.closest(".t-rec");e.querySelectorAll(".tn-video-controls.play")[t].closest(".tn-elem").classList.remove("active"),e.querySelectorAll(".tn-video-controls.pause")[t].closest(".tn-elem").classList.add("active")}}),10)},l=function(e,t,o){null==t&&(t=0);const l=document.querySelectorAll(e)[t];if(l.classList.contains("playing")&&(l.querySelector("video").pause(),l.classList.remove("playing"),o.controls)){const e=l.closest(".t-rec");e.querySelectorAll(".tn-video-controls.play")[t].closest(".tn-elem").classList.add("active"),e.querySelectorAll(".tn-video-controls.pause")[t].closest(".tn-elem").classList.remove("active")}},s=function(e,t){null==t&&(t=0);document.querySelectorAll(e)[t].querySelector("video").setAttribute("loop","")},n=function(e,t){null==t&&(t=0);document.querySelectorAll(e)[t].querySelector("video").removeAttribute("loop")},c=function(e,t,o){null==t&&(t=0);const l=document.querySelectorAll(e),s=l[t].querySelector("video"),n=l[t].closest(".t-rec");s.addEventListener("ended",(function(){if(l[t].classList.remove("playing"),s.currentTime=0,o.controls){const e=n.querySelectorAll(".tn-video-controls.play")[t].closest(".tn-elem"),o=n.querySelectorAll(".tn-video-controls.pause")[t].closest(".tn-elem");e.classList.add("active"),o.classList.remove("active")}}))},i=function(e,t){document.querySelectorAll(e).forEach(((o,s)=>l(e,s,t)))},r=function(){if(!window.video.load){let e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/gh/postnikovmd/tilda@"+window.video.version+"/media.min.css",document.head.appendChild(e),window.video.load=!0}};void 0===window.postnikovmd&&(window.postnikovmd="Maksim Postnikov, https://postnikovmd.com"),e.video={init:function(e,i){if(null==i)i={};null==i.hover&&(i.hover=!1),null==i.controls&&(i.controls=!0),null==i.pauseAll&&(i.pauseAll=!1),null==i.play&&(i.play="#play"),null==i.pause&&(i.pause="#pause"),null==i.notAllowed&&(i.notAllowed=!1),t_onReady((function(){isMobile&&(i.hover=!1),0==i.controls&&0==i.hover?i.interactive=!1:i.interactive=!0,i.hover&&(i.pauseAll=!1),isMobile&&(i.pauseAll=!0);var a=document.querySelectorAll(e);if(a.length>0){var d=a[0].closest(".t-rec");d.querySelectorAll('a[href="'+i.play+'"]').forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-video-controls","play"),e.closest(".tn-elem").style.cursor="pointer"})),d.querySelectorAll('a[href="'+i.pause+'"]').forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-video-controls","pause"),e.closest(".tn-elem").style.cursor="pointer"})),a.forEach(((r,a)=>{r.classList.add("tn-video");var u=d.querySelectorAll(".tn-video-controls.play")[a],v=d.querySelectorAll(".tn-video-controls.pause")[a];if(i.controls&&(r.setAttribute("data-controls",""),u?v?i.autoplay||i.notAllowed?(u.closest(".tn-elem").classList.remove("active"),v.closest(".tn-elem").classList.add("active")):(u.closest(".tn-elem").classList.add("active"),v.closest(".tn-elem").classList.remove("active")):console.error("[media.js] Ошибка: Не найдена кнопка "+i.pause+" для видео "+a+". Проверьте правильность ссылки или задайте параметр controls = false"):console.error("[media.js] Ошибка: Не найдена кнопка "+i.play+" для видео "+a+". Проверьте правильность ссылки или задайте параметр controls = false")),i.hover){r.setAttribute("data-hover","");let t=setInterval((function(){navigator.userActivation.hasBeenActive&&(clearInterval(t),r.querySelector(".tn-atom__videoiframe").click(),setTimeout((function(){l(e,a,i)}),100))}),100)}let p=setInterval((function(){let d=r.querySelector("video");if(d){if(clearInterval(p),d.hasAttribute("autoplay")){if(i.autoplay=!0,r.classList.add("playing"),i.loop&&s(e,a),void 0!==i.preview){r.setAttribute("data-preview",i.preview);let t=document.createElement("style");t.textContent=".tn-video .tn-atom { --video-preview: url("+i.preview+") }",r.appendChild(t);const o=d.play();void 0!==o&&o.then((()=>{})).catch((t=>{"NotAllowedError"===t.name&&(i.notAllowed=!0,r.classList.add("notallowed"),l(e,a,i))}))}}else i.autoplay=!1,o(e,a,i);i.loop=d.hasAttribute("loop"),i.muted=d.hasAttribute("muted")||i.hover||i.autoplay,d.muted=i.muted,i.autoplay&&d.hasAttribute("loop")&&s(e,a),setTimeout((function(){i.interactive&&(r.style.cursor="pointer",i.controls&&u&&v&&(u.addEventListener("click",(()=>o(e,a,i))),v.addEventListener("click",(()=>l(e,a,i)))),i.hover&&(r.addEventListener("mouseenter",(function(){r.classList.add("hover"),r.classList.contains("loaded")?o(e,a,i):t(e,a,i)})),r.addEventListener("mouseleave",(function(){r.classList.remove("hover"),d.hasAttribute("loop")?r.classList.contains("playing")&&(n(e,a),c(e,a,i)):l(e,a,i)}))),r.addEventListener("click",(function(){i.interactive&&i.notAllowed&&r.classList.remove("notallowed"),r.classList.contains("playing")?l(e,a,i):o(e,a,i)})))}),10)}}),100)})),r()}else console.error("[media.js] Ошибка: Элементы с видео не найдены (selector: "+e+")")}))},copyright:"© "+window.postnikovmd,version:"1.1"}}(window);
!function(e){let t=function(e,t){const o=document.querySelector(e);if(!o.classList.contains("playing")){if(o.querySelector("audio").play(),o.classList.add("playing"),t.controls){document.querySelectorAll("."+t.play.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.remove("active")}));document.querySelectorAll("."+t.pause.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.add("active")}))}}},o=function(e,t){const o=document.querySelector(e);if(o.classList.contains("playing")){if(o.querySelector("audio").pause(),o.classList.remove("playing"),t.controls){document.querySelectorAll("."+t.play.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.add("active")}));document.querySelectorAll("."+t.pause.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.remove("active")}))}}};e.audio={init:function(e,s){if(null==s)s={};null==s.source&&(s.source=""),null==s.volume&&(s.volume=1),null==s.controls&&(s.controls=!0),null==s.play&&(s.play="#audio-play"),null==s.pause&&(s.pause="#audio-pause"),t_onReady((function(){if(void 0!==e){const l=document.querySelector(".t-records"),c=document.createElement("div");c.className=e.substring(1),c.innerHTML=`<audio><source src="${s.source}"></audio>`,l.appendChild(c);const r=document.querySelector(e),n=document.querySelector(".t-records");setTimeout((function(){const e=r.querySelector("audio");s.loop=e.hasAttribute("loop"),e.volume=s.volume}),10),setTimeout((function(){if(s.controls){var l=n.querySelectorAll('a[href="'+s.play+'"]');l.forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-video-controls",s.play.substr(1)),e.closest(".tn-elem").style.cursor="pointer"}));var c=n.querySelectorAll('a[href="'+s.pause+'"]');if(c.forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-video-controls",s.pause.substr(1)),e.closest(".tn-elem").style.cursor="pointer"})),l)if(c){l.forEach((o=>{o.classList.add("active"),o.addEventListener("click",(function(){t(e,s)}))})),c.forEach((t=>{t.classList.remove("active"),t.addEventListener("click",(function(){o(e,s)}))}));const r=document.createElement("style");r.textContent=".tn-video-controls { cursor: pointer !important; } .tn-video-controls.active { z-index: 120 !important; }",n.appendChild(r)}else console.error("[media.js] Ошибка: Не найдена кнопка "+s.pause);else console.error("[media.js] Ошибка: Не найдена кнопка "+s.play)}}),20)}else console.error("[media.js] Ошибка: Не задан класс для аудиофайла")}))},copyright:"© "+window.postnikovmd,version:"1.1"}}(window);
