!function(e){let t=function(e,t,l){const o=document.querySelectorAll(e)[t];o.classList.contains("loaded")||(o.querySelector(".tn-atom").click(),o.classList.add("loaded"))},l=function(e,t,l){l.pauseAll&&r(e,l),setTimeout((function(){null==t&&(t=0);const o=document.querySelectorAll(e)[t];if(!o.classList.contains("playing")&&(o.querySelector("video").play(),o.classList.add("playing"),l.controls)){const e=o.closest(".t-rec");e.querySelectorAll(".tn-controls.play")[t].closest(".tn-elem").classList.remove("active"),e.querySelectorAll(".tn-controls.pause")[t].closest(".tn-elem").classList.add("active")}}),10)},o=function(e,t,l){null==t&&(t=0);const o=document.querySelectorAll(e)[t];if(o.classList.contains("playing")&&(o.querySelector("video").pause(),o.classList.remove("playing"),l.controls)){const e=o.closest(".t-rec");e.querySelectorAll(".tn-controls.play")[t].closest(".tn-elem").classList.add("active"),e.querySelectorAll(".tn-controls.pause")[t].closest(".tn-elem").classList.remove("active")}},s=function(e,t){null==t&&(t=0);document.querySelectorAll(e)[t].querySelector("video").setAttribute("loop","")},n=function(e,t){null==t&&(t=0);document.querySelectorAll(e)[t].querySelector("video").removeAttribute("loop")},c=function(e,t,l){null==t&&(t=0);const o=document.querySelectorAll(e),s=o[t].querySelector("video"),n=o[t].closest(".t-rec");s.addEventListener("ended",(function(){if(o[t].classList.remove("playing"),s.currentTime=0,l.controls){const e=n.querySelectorAll(".tn-controls.play")[t].closest(".tn-elem"),l=n.querySelectorAll(".tn-controls.pause")[t].closest(".tn-elem");e.classList.add("active"),l.classList.remove("active")}}))},r=function(e,t){document.querySelectorAll(e).forEach(((l,s)=>o(e,s,t)))},i=function(){if(!window.video.load){let e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/gh/postnikovmd/tilda@"+window.video.version+"/media.min.css",document.head.appendChild(e),window.video.load=!0}};void 0===window.postnikovmd&&(window.postnikovmd="Maksim Postnikov, https://postnikovmd.com"),e.video={init:function(e,r){if(null==r)r={};null==r.hover&&(r.hover=!1),null==r.controls&&(r.controls=!0),null==r.pauseAll&&(r.pauseAll=!1),null==r.play&&(r.play="#play"),null==r.pause&&(r.pause="#pause"),null==r.notAllowed&&(r.notAllowed=!1),t_onReady((function(){isMobile&&(r.hover=!1),0==r.controls&&0==r.hover?r.interactive=!1:r.interactive=!0,r.hover&&(r.pauseAll=!1),isMobile&&(r.pauseAll=!0);var a=document.querySelectorAll(e);if(a.length>0){var u=a[0].closest(".t-rec");u.querySelectorAll('a[href="'+r.play+'"]').forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-controls","play"),e.closest(".tn-elem").style.cursor="pointer"})),u.querySelectorAll('a[href="'+r.pause+'"]').forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-controls","pause"),e.closest(".tn-elem").style.cursor="pointer"})),a.forEach(((i,a)=>{i.classList.add("tn-video");var d=u.querySelectorAll(".tn-controls.play")[a],v=u.querySelectorAll(".tn-controls.pause")[a];if(r.controls&&(i.setAttribute("data-controls",""),d?v?r.autoplay||r.notAllowed?(d.closest(".tn-elem").classList.remove("active"),v.closest(".tn-elem").classList.add("active")):(d.closest(".tn-elem").classList.add("active"),v.closest(".tn-elem").classList.remove("active")):console.error("[media.js] Ошибка: Не найдена кнопка "+r.pause+" для видео "+a+". Проверьте правильность ссылки или задайте параметр controls = false"):console.error("[media.js] Ошибка: Не найдена кнопка "+r.play+" для видео "+a+". Проверьте правильность ссылки или задайте параметр controls = false")),r.hover){i.setAttribute("data-hover","");let t=setInterval((function(){navigator.userActivation.hasBeenActive&&(clearInterval(t),i.querySelector(".tn-atom__videoiframe").click(),setTimeout((function(){o(e,a,r)}),100))}),100)}let p=setInterval((function(){let u=i.querySelector("video");if(u){if(clearInterval(p),u.hasAttribute("autoplay")){if(r.autoplay=!0,i.classList.add("playing"),r.loop&&s(e,a),void 0!==r.preview){i.setAttribute("data-preview",r.preview);let t=document.createElement("style");t.textContent=".tn-video .tn-atom { --video-preview: url("+r.preview+") }",i.appendChild(t);const l=u.play();void 0!==l&&l.then((()=>{})).catch((t=>{"NotAllowedError"===t.name&&(r.notAllowed=!0,i.classList.add("notallowed"),o(e,a,r))}))}}else r.autoplay=!1,l(e,a,r);r.loop=u.hasAttribute("loop"),r.muted=u.hasAttribute("muted")||r.hover||r.autoplay,u.muted=r.muted,r.autoplay&&u.hasAttribute("loop")&&s(e,a),setTimeout((function(){r.interactive&&(i.style.cursor="pointer",r.controls&&d&&v&&(d.addEventListener("click",(()=>l(e,a,r))),v.addEventListener("click",(()=>o(e,a,r)))),r.hover&&(i.addEventListener("mouseenter",(function(){i.classList.add("hover"),i.classList.contains("loaded")?l(e,a,r):t(e,a,r)})),i.addEventListener("mouseleave",(function(){i.classList.remove("hover"),u.hasAttribute("loop")?i.classList.contains("playing")&&(n(e,a),c(e,a,r)):o(e,a,r)}))),i.addEventListener("click",(function(){r.interactive&&r.notAllowed&&i.classList.remove("notallowed"),i.classList.contains("playing")?o(e,a,r):l(e,a,r)})))}),10)}}),100)})),i()}else console.error("[media.js] Ошибка: Элементы с видео не найдены (selector: "+e+")")}))},copyright:"© "+window.postnikovmd,version:"1.1"}}(window);
!function(e){let t=function(e,t){const o=document.querySelector(e);if(!o.classList.contains("playing")){if(o.querySelector("audio").play(),o.classList.add("playing"),t.controls){document.querySelectorAll("."+t.play.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.remove("active")}));document.querySelectorAll("."+t.pause.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.add("active")}))}}},o=function(e,t){const o=document.querySelector(e);if(o.classList.contains("playing")){if(o.querySelector("audio").pause(),o.classList.remove("playing"),t.controls){document.querySelectorAll("."+t.play.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.add("active")}));document.querySelectorAll("."+t.pause.substr(1)).forEach((e=>{e.closest(".tn-elem").classList.remove("active")}))}}};e.audio={init:function(e,s){if(null==s)s={};null==s.source&&(s.source=""),null==s.volume&&(s.volume=1),null==s.controls&&(s.controls=!0),null==s.play&&(s.play="#audio-play"),null==s.pause&&(s.pause="#audio-pause"),t_onReady((function(){if(void 0!==e){const l=document.querySelector(".t-records"),c=document.createElement("div");c.className=e.substring(1),c.innerHTML=`<audio><source src="${s.source}"></audio>`,l.appendChild(c);const r=document.querySelector(e),n=document.querySelector(".t-records");setTimeout((function(){const e=r.querySelector("audio");s.loop=e.hasAttribute("loop"),e.volume=s.volume}),10),setTimeout((function(){if(s.controls){var l=n.querySelectorAll('a[href="'+s.play+'"]');l.forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-controls",s.play.substr(1)),e.closest(".tn-elem").style.cursor="pointer"}));var c=n.querySelectorAll('a[href="'+s.pause+'"]');if(c.forEach((e=>{e.removeAttribute("href"),e.closest(".tn-elem").classList.add("tn-controls",s.pause.substr(1)),e.closest(".tn-elem").style.cursor="pointer"})),l)if(c){l.forEach((o=>{o.classList.add("active"),o.addEventListener("click",(function(){t(e,s)}))})),c.forEach((t=>{t.classList.remove("active"),t.addEventListener("click",(function(){o(e,s)}))}));const r=document.createElement("style");r.textContent=".tn-controls { cursor: pointer !important; } .tn-controls.active { z-index: 120 !important; }",n.appendChild(r)}else console.error("[media.js] Ошибка: Не найдена кнопка "+s.pause);else console.error("[media.js] Ошибка: Не найдена кнопка "+s.play)}}),20)}else console.error("[media.js] Ошибка: Не задан класс для аудиофайла")}))},copyright:"© "+window.postnikovmd,version:"1.1"}}(window);